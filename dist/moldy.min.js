!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.moldy=e()}}(function(){return function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return a(n?n:e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t){function n(e){return e?r(e):void 0}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,a=n.length;a>r;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],2:[function(e,t){var n=e("sc-contains"),r=e("sc-is"),a=function(e,t,o,i){var s,c=t,u=r.an.array(i)?i:[];switch(!0){case/float|integer/.test(c):c="number"}if(r.a[c](e)||"*"===c)s=e;else switch(!0){case"array"===c:try{if(r.a.string(e)&&(s=JSON.parse(e)),r.not.an.array(s))throw""}catch(l){r.not.nullOrUndefined(e)&&(s=[e])}break;case"boolean"===c:try{s=/^(true|1|y|yes)$/i.test(e.toString())?!0:void 0}catch(l){}if(r.not.a.boolean(s))try{s=/^(false|-1|0|n|no)$/i.test(e.toString())?!1:void 0}catch(l){}s=r.a.boolean(s)?s:void 0;break;case"date"===c:try{s=new Date(e),s=isNaN(s.getTime())?void 0:s}catch(l){}break;case"string"===c:try{if(s=JSON.stringify(e),r.undefined(s))throw""}catch(l){try{s=e.toString()}catch(l){}}break;case"number"===c:try{s=parseFloat(e),(r.not.a.number(s)||isNaN(s))&&(s=void 0)}catch(l){s=void 0}if(void 0!==s)switch(!0){case"integer"===t:s=parseInt(s)}break;default:try{s=a(JSON.parse(e),c)}catch(l){}}return u.length>0&&!n(u,s)&&(s=u[0]),r.not.undefined(s)?s:r.not.undefined(o)?o:null};t.exports=a},{"sc-contains":3,"sc-is":7}],3:[function(e,t){var n=function(e,t){var n=!1;return Array.isArray(e)?e.forEach(function(e){n===!1&&t===e&&(n=!0)}):Object(e)===e&&Object.keys(e).forEach(function(r){n===!1&&e[r]===t&&(n=!0)}),n};t.exports=n},{}],4:[function(e,t,n){var r="{?[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-4[0-9A-Fa-f]{3}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}}?";n.generate=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:7&n|8).toString(16)});return t},n.match=function(e){var t=new RegExp(r,"g"),n=("string"==typeof e?e:"").match(t);return Array.isArray(n)?n:[]},n.isValid=function(e){var t=new RegExp(r);return t.test(e)}},{}],5:[function(e,t){function n(e,t,o){e="object"===r(e)?e:{},t="array"===r(t)?t:[],o="string"===r(o)?o:"";var i=t.length>0?t.shift():"",s=a.call(e,i)||void 0!==e[i],c=s?e[i]:void 0,u=r(c)===o;return t.length>0&&s?n(e[i],t,o):t.length>0||""===o?s:s&&u}var r=e("type-component"),a=Object.prototype.hasOwnProperty;t.exports=function(e,t,a){return t="string"===r(t)?t.split("."):[],n(e,t,a)}},{"type-component":6}],6:[function(e,t){var n=Object.prototype.toString;t.exports=function(e){switch(n.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array"}return null===e?"null":void 0===e?"undefined":e===Object(e)?"object":typeof e}},{}],7:[function(e,t,n){var r=e("./ises/type"),a={a:{},an:{},not:{a:{},an:{}}},o={arguments:["arguments",r("arguments")],array:["array",r("array")],"boolean":["boolean",r("boolean")],date:["date",r("date")],"function":["function","func","fn",r("function")],"null":["null",r("null")],number:["number","integer","int",r("number")],object:["object",r("object")],regexp:["regexp",r("regexp")],string:["string",r("string")],undefined:["undefined",r("undefined")],empty:["empty",e("./ises/empty")],nullorundefined:["nullOrUndefined","nullorundefined",e("./ises/nullorundefined")],guid:["guid",e("./ises/guid")]};Object.keys(o).forEach(function(e){var t=o[e].slice(0,o[e].length-1),n=o[e][o[e].length-1];t.forEach(function(e){a[e]=a.a[e]=a.an[e]=n,a.not[e]=a.not.a[e]=a.not.an[e]=function(){return n.apply(this,arguments)?!1:!0}})}),n=t.exports=a,n.type=r},{"./ises/empty":8,"./ises/guid":9,"./ises/nullorundefined":10,"./ises/type":11}],8:[function(e,t){var n=e("../type");t.exports=function(e){var t=!1;return"null"===n(e)||"undefined"===n(e)?t=!0:"object"===n(e)?t=0===Object.keys(e).length:"boolean"===n(e)?t=e===!1:"number"===n(e)?t=0===e||-1===e:("array"===n(e)||"string"===n(e))&&(t=0===e.length),t}},{"../type":12}],9:[function(e,t){var n=e("sc-guid");t.exports=function(e){return n.isValid(e)}},{"sc-guid":4}],10:[function(e,t){t.exports=function(e){return null===e||void 0===e||void 0===e}},{}],11:[function(e,t){var n=e("../type");t.exports=function(e){return function(t){return n(t)===e}}},{"../type":12}],12:[function(e,t){var n=Object.prototype.toString;t.exports=function(e){switch(n.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array"}return null===e?"null":void 0===e?"undefined":e===Object(e)?"object":typeof e}},{}],13:[function(e,t){var n=e("type-component"),r=function(){var e=Array.prototype.slice.call(arguments),t="boolean"===n(e[0])?e.shift():!1,a=e,o={};return a.forEach(function(e){"object"===n(e)&&Object.keys(e).forEach(function(a){Object.prototype.hasOwnProperty.call(e,a)&&(o[a]=t&&"object"===n(e[a])?r(t,{},o[a],e[a]):e[a])})}),o};t.exports=r},{"type-component":14}],14:[function(e,t){t.exports=e(6)},{}],15:[function(e,t){t.exports={defaults:{middlewareKey:"all"}}},{}],16:[function(e,t){var n=e("sc-is"),r=e("./config.json"),a=function(){},o=function(e,t,r){return n.not.empty(t)&&n.a.string(t)?(n.not.an.array(e[t])&&(e[t]=[]),n.a.func(r)&&e[t].push(r),e[t]):void 0},i=function(){this.functions={all:[]}};i.prototype.use=function(){var e=this,t=Array.prototype.slice.call(arguments),i=n.a.string(t[0])?t.shift():r.defaults.middlewareKey,s=n.a.func(t[0])?t.shift():a;o(e.functions,i,s)},i.prototype.middleware=function(){var e=this,t=0,i=Array.prototype.slice.call(arguments),s=n.a.string(i[0])&&n.a.func(i[1])?i.shift():r.defaults.middlewareKey,c=n.a.func(i[0])?i.shift():a;o(e.functions,s);var u=function(){var n=e.functions[s][t++],r=Array.prototype.slice.call(arguments);n?(r.push(u),n.apply(e.context,r)):c.apply(e.context,r)};u.apply(e.context,i)},i.prototype.clear=function(e){n.a.string(e)&&n.not.empty(e)?this.functions[e]=[]:this.functions={all:[]}},t.exports=function(e){var t=new i;n.an.object(e)?(Object.defineProperties(e,{use:{value:function(){return t.use.apply(t,arguments),e}},middleware:{value:function(){t.middleware.apply(t,arguments)}},useify:{value:t}}),t.context=e):n.a.fn(e)&&(e.prototype.middleware=function(){t.context=this,t.middleware.apply(t,arguments)},e.use=function(){return t.use.apply(t,arguments),this},e.useify=t)}},{"./config.json":15,"sc-is":7}],17:[function(e,t){var n=function(e){var t={},n=Array.isArray(e)?e:[],r=function(e){var r=Array.prototype.slice.call(arguments,1);return t[e]?t[e].apply(n,r):n["__"+e].apply(n,r)};return Object.defineProperties(n,{on:{value:function(e,n){t[e]=n}}}),Object.defineProperty(n,"pop",{value:function(){return r("pop",n[n.length-1])}}),Object.defineProperty(n,"__pop",{value:function(){return Array.prototype.pop.apply(n,arguments)}}),Object.defineProperty(n,"shift",{value:function(){return r("shift",n[0])}}),Object.defineProperty(n,"__shift",{value:function(){return Array.prototype.shift.apply(n,arguments)}}),["push","reverse","unshift","sort","splice"].forEach(function(e){var t={};t[e]={value:r.bind(null,e)},t["__"+e]={value:function(){return Array.prototype[e].apply(n,arguments)}},Object.defineProperties(n,t)}),n};t.exports=n},{}],18:[function(e,t,n){var r=e("sc-is"),a=e("sc-cast"),o=e("sc-haskey"),i=e("./helpers"),s=e("sc-merge"),c=e("emitter-component"),u=e("sc-useify"),l=e("./request"),p=e("sg-observable-array"),f=function(e,t){var n=this,o=r.an.object(t)?t:{};Object.defineProperties(n,{__moldy:{value:!0},__attributes:{value:{},writable:!0},__baseUrl:{value:a(o.baseUrl,"string",""),writable:!0},__data:{value:{},writable:!0},__destroyed:{value:!1,writable:!0},__headers:{value:a(o.headers,"object",{}),writable:!0},__key:{value:a(o.key,"string","id")||"id",writable:!0},__keyless:{value:o.keyless===!0},__name:{value:e||o.name||""},__url:{value:a(o.url,"string",""),writable:!0},busy:{value:!1,writable:!0}}),o.keyless||n.$property(n.__key),Object.keys(a(o.properties,"object",{})).forEach(function(e){n.$property(e,o.properties[e])}),n.on("presave",i.setBusy(n)),n.on("save",i.unsetBusy(n)),n.on("predestroy",i.setBusy(n)),n.on("destroy",i.unsetBusy(n)),n.on("preget",i.setBusy(n)),n.on("get",i.unsetBusy(n))};f.prototype.$baseUrl=function(e){var t=this,n=a(e,"string",t.__baseUrl||"");return t.__baseUrl=n.trim().replace(/(\/|\s)+$/g,""),r.not.a.string(e)?t.__baseUrl:t},f.prototype.$clone=function(e){var t=this,n=a(e,"object",{}),r=new f(t.__name,{baseUrl:t.__baseUrl,headers:t.__headers,key:t.__key,keyless:t.__keyless,url:t.__url});return Object.keys(t.__attributes).forEach(function(e){r.$property(e,s(t.__attributes[e])),r[e]=n[e]}),r},f.prototype.$collection=function(e){var t=this,n=t.$url(),a="get",o=r.an.object(e)?e:{},s=r.a.func(e)?e:r.a.func(_callback)?_callback:i.noop;t.emit("precollection",{moldy:t,method:a,query:o,url:n,callback:s}),l(t,o,a,n,function(e,n){t.emit("collection",e,n),s.apply(t,arguments)})},f.prototype.$destroy=function(e){var t=this,n=t.$isDirty(),a=t.$json(),o=t.$url()+(t.__keyless?"":"/"+t[t.__key]),s="delete",c=r.a.func(e)?e:i.noop;t.emit("predestroy",{moldy:t,data:a,method:s,url:o,callback:c}),n?c.apply(t,[new Error("This moldy cannot be destroyed because it has not been saved to the server yet.")]):l(t,a,s,o,function(){t.emit("destroy",t),t.__destroyed=!0,c.apply(t,arguments)})},f.prototype.$data=function(e){var t=this,n=r.object(e)?e:{};return Object.keys(n).forEach(function(e){t.__attributes.hasOwnProperty(e)&&(r.an.array(n[e])&&o(t.__attributes[e],"arrayOfAType","boolean")&&t.__attributes[e].arrayOfAType===!0?n[e].forEach(function(n){t[e].push(n)}):r.a.object(n[e])&&t[e]instanceof f?t[e].$data(n[e]):t[e]=n[e])}),t},f.prototype.$get=function(e,t){var n=this,a=n.$url(),o="get",s=r.an.object(e)?e:{},c=r.a.func(e)?e:r.a.func(t)?t:i.noop;n.emit("preget",{moldy:n,method:o,query:s,url:a,callback:c}),l(n,s,o,a,function(e,t){var a=t instanceof f?t:r.an.array(t)?t[0]:t;n.emit("get",e,a),c.apply(n,[e,a])})},f.prototype.$headers=function(e){return this.__headers=r.an.object(e)?e:this.__headers,r.not.an.object(e)?this.__headers:this},f.prototype.$isDirty=function(){return r.empty(this[this.__key])},f.prototype.$isValid=function(){var e=this,t=!0;return Object.keys(e.__attributes).forEach(function(n){if(!e.$isDirty()||n!==e.__key){var a=e[n],i=e.__attributes[n],s=i.type,c=o(i,"arrayOfAType","boolean")?i.arrayOfAType===!0:!1,u=i.optional!==!0,l=e.__keyless?!1:c?0===a.length:r.nullOrUndefined(a),p=r.not.empty(s)&&r.a.string(s)?r.not.a[s](a):l;c&&r.not.empty(a)&&a[0]instanceof f&&a.forEach(function(e){t&&e.$isValid()===!1&&(t=!1)}),t&&u&&p&&(t=!1)}}),t},f.prototype.$json=function(){var e=this,t=e.__data,n={};return Object.keys(t).forEach(function(e){r.an.array(t[e])&&t[e][0]instanceof f?(n[e]=[],t[e].forEach(function(t){n[e].push(t.$json())})):r.not.an.object(t[e])?n[e]=t[e]:t[e]instanceof f&&(n[e]=t[e].$json())}),n},f.prototype.$property=function(e,t){var n=this,s=new i.attributes(e,t),c=n[e],u=r.a.string(s.type)&&/moldy/.test(s.type),l=r.an.array(s.type),y=r.an.array(t)&&o(t[0],"properties","object"),d=r.an.array(t)&&r.a.string(t[0]),h=l&&o(s.type[0],"properties","object"),b=l&&r.a.string(s.type[0])&&r.not.empty(s.type[0]),_=o(t,"properties","object");if(!n.hasOwnProperty(e)||!n.__attributes.hasOwnProperty(e)){if((y||d)&&(s.type=t,h=y,b=d,l=!0),u)Object.defineProperty(n,e,{value:s["default"],enumerable:!0}),n.__data[e]=n[e];else if(_)Object.defineProperty(n,e,{value:new f(t.name,t),enumerable:!0}),n.__data[e]=n[e];else if(l){var m=p([]),v=b||h?s.type[0]:"*";s.arrayOfAType=!0,Object.defineProperty(n,e,{value:m,enumerable:!0}),n.__data[e]=n[e],["push","unshift"].forEach(function(e){m.on(e,function(){var t=Array.prototype.slice.call(arguments),n=[];return t.forEach(function(e){if(h){var t=new f(v.name,v),o=r.an.object(e)?e:s["default"];t.$data(o),n.push(t)}else n.push(a(e,v,s["default"]))}),m["__"+e].apply(m,n)})})}else Object.defineProperty(n,e,{get:i.getProperty(e),set:i.setProperty(e),enumerable:!0});n.__attributes[e]=s}return void 0!==c?n[e]=c:r.empty(n[e])&&s.optional===!1&&r.not.nullOrUndefined(s["default"])?n[e]=s["default"]:r.empty(n[e])&&s.optional===!1&&(n.__data[e]=l||u?n[e]:r.empty(s.type)?void 0:a(void 0,s.type)),n},f.prototype.$save=function(e){var t=this,n=t.$isDirty(),a=t.$json(),o=t.$url()+(n||t.__keyless?"":"/"+t[t.__key]),s=n?"post":"put",c=r.a.func(e)?e:i.noop;t.emit("presave",{moldy:t,data:a,method:s,url:o,callback:c}),l(t,a,s,o,function(e,n){t.emit("save",e,n),c.apply(t,arguments)})},f.prototype.$url=function(e){var t=this,n=r.empty(t.__baseUrl)?"":t.__baseUrl,a=r.empty(t.__name)?"":"/"+t.__name.trim().replace(/^\//,""),o=e||t.__url||"",i=n+a+(r.empty(o)?"":"/"+o.trim().replace(/^\//,""));return t.__url=o.trim().replace(/^\//,""),r.not.a.string(e)?i:t},c(f.prototype),u(f),n=t.exports=f},{"./helpers":19,"./request":20,"emitter-component":1,"sc-cast":2,"sc-haskey":5,"sc-is":7,"sc-merge":13,"sc-useify":16,"sg-observable-array":17}],19:[function(e,t,n){var r=e("sc-is"),a=e("sc-cast"),o=e("sc-merge");n.attributes=function(e,t){var n;return n=r.a.string(t)?{type:t}:r.an.object(t)&&t.__moldy===!0?{type:"moldy","default":t}:t,o({name:e||"",type:"","default":null,optional:!1},n)},n.getProperty=function(e){return function(){return this.__data[e]}},n.setBusy=function(e){return function(){e.busy=!0}},n.setProperty=function(e){return function(t){var n=this,r=n.__attributes[e],o=r.type?a(t,r.type,r["default"]):t;n.__data[e]!==o&&n.emit("change",n.__data[e],o),n.__data[e]=o}},n.unsetBusy=function(e){return function(){e.busy=!1}},n.noop=function(){}},{"sc-cast":2,"sc-is":7,"sc-merge":13}],20:[function(e,t){var n=e("sc-is"),r=(e("sc-cast"),e("sc-haskey"));t.exports=function(e,t,a,o,i){var s=e,c=[],u=r(t,s.__key)&&n.not.empty(t[s.__key])&&/get/.test(a),l=s.$isDirty();s.middleware(function(e){var t=Array.prototype.slice.call(arguments),a=e===s?null:t.shift(),o=t.shift();!a||a instanceof Error||(a=new Error("An unknown error occurred")),!a&&l&&n.object(o)&&u&&!r(o,s.__key)&&(a=new Error("The response from the server did not contain a valid `"+s.__key+"`")),!a&&l&&n.object(o)&&(s[s.__key]=o[s.__key]),a||(n.array(o)?(o.forEach(function(e){c.push(s.$clone(e))}),s=c):s.$data(o)),i&&i(a,s)},e,t,a,o)}},{"sc-cast":2,"sc-haskey":5,"sc-is":7}]},{},[18])(18)});